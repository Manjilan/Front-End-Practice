<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Event Emitter</title>
</head>
<body>
<script>
  class EventEmitter {
    constructor(){
      this.eventArray = [];
    }

    on(eventName, defaultFunction){
      let index = this.eventArray.findIndex((evt) => evt.eventName === eventName);
      if(index === -1){
        let evt = {};
        evt.eventName = eventName;
        evt.defaultFunction = defaultFunction;
        this.eventArray.push(evt);
      }
      else {
        this.eventArray[index].defaultFunction = defaultFunction;
      }

    }

    once(eventName, onceFunction ){
      let index = this.eventArray.findIndex((evt) => evt.eventName === eventName);
      if(index !== -1) {
        this.eventArray[index].onceFunction = onceFunction;
      }
      else {
        let evt = {};
        evt.eventName = eventName;
        evt.onceFunction = onceFunction;
        this.eventArray.push(evt)
      }
    }

    emit(eventName, ...args){
      let index = this.eventArray.findIndex((evt) => evt.eventName === eventName);
      if(index !== -1){
        if(this.eventArray[index].hasOwnProperty('onceFunction')){
          this.eventArray[index].onceFunction(args);
          delete this.eventArray[index].onceFunction;
        }
        else {
          this.eventArray[index].hasOwnProperty('defaultFunction') && this.eventArray[index].defaultFunction(args);
        }
      }
    }
    off(eventName, defaultFunction){
      let index = this.eventArray.findIndex((evt) => evt.eventName === eventName);
      index !== -1 && this.eventArray.splice(index, 1);
    }
  }
  var eventEmitter = new EventEmitter();

  function responseToEvent(msg) {
      console.log(msg);
  }

  eventEmitter.on('anotherEvent', responseToEvent);
  eventEmitter.once('pramp', function(msg) { console.log(msg + ' just once!'); });
  eventEmitter.emit('pramp', '1st');
  eventEmitter.emit('pramp', '2nd');
  eventEmitter.off('pramp', responseToEvent);
  eventEmitter.emit('pramp', '3rd');
  eventEmitter.on('pramp', () => {console.log('another callback');});
  eventEmitter.emit('pramp', '1st');
  </script>
  </body>
</html>
